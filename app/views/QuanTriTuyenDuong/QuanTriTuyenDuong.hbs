<div class="right_col" role="main">
    <div class="row">
        <p style="font-size: 50px; margin-left: 35px;">
            Quản lý các tuyến đường
        </p>
        <div class="col-md-12">
            <div id="jsGrid"></div>
        </div>
    </div>
</div>
<script>
    $.get('/QuanTriTuyenDuong/XemTuyenDuong', function(result) {
        console.log(result);
        if (result.error == 'error') {
            alert('Có lỗi xảy ra: ' + error);
        } else {
            $("#jsGrid").jsGrid({
                width: "100%",
                height: "400px",

                inserting: true,
                editing: true,
                sorting: true,
                paging: true,
                height: "auto",
                filtering: true,
                autoload: true,
                controller: {
                    data: result.result,
                    loadData: function(filter) {
                        return $.grep(this.data, function(item) {
                            return (!filter["Mã tuyến đường"] || item["Mã tuyến đường"].indexOf(filter["Mã tuyến đường"]) >= 0) &&
                                (!filter["Nơi xuất phát"] || item["Nơi xuất phát"].indexOf(filter["Nơi xuất phát"]) >= 0) &&
                                (!filter["Nơi đến"] || item["Nơi đến"].indexOf(filter["Nơi đến"]) >= 0) &&
                                (!filter["Bến đi"] || item["Bến đi"].indexOf(filter["Bến đi"]) >= 0) &&
                                (!filter["Quảng đường"] || item["Quảng đường"].indexOf(filter["Quảng đường"]) >= 0) &&
                                (!filter["Bến đến"] || item["Bến đến"].indexOf(filter["Bến đến"]) >= 0);
                        });
                    }
                },

                confirmDeleting: true,
                deleteConfirm: "Bạn có chắc xóa không?",

                fields: [{
                        name: "Mã tuyến đường",
                        type: "text",
                        width: 50,
                    },
                    {
                        name: "Nơi xuất phát",
                        type: "text",
                        width: 50,
                        validate: "required"
                    },
                    {
                        name: "Nơi đến",
                        type: "text",
                        width: 50,
                        validate: "required"
                    },
                    {
                        name: "Bến đi",
                        type: "text",
                        width: 50,
                        validate: "required"
                    },
                    {
                        name: "Bến đến",
                        type: "text",
                        width: 50,
                        validate: "required"
                    },
                    {
                        name: "Quảng đường",
                        type: "number",
                        width: 50,
                        validate: "required"
                    },
                    {
                        type: "control"
                    }
                ],
                onItemDeleted: function(args) {
                    console.log(args.item["Nơi xuất phát"]);
                    $.post("/QuanTriTuyenDuong/XoaTuyenDuong", args.item, function(result) {
                        console.log(result);
                        if (result.error) {
                            alert(result.error);
                        } else {
                            if (result) {
                                alert('Có lỗi trong quá trình xóa');
                            }
                        }
                    });
                },
                onItemInserted: function(args) {
                    $.post("/QuanTriTuyenDuong/ThemTuyenDuong", args.item, function(result) {
                        console.log(result);
                        if (result.error) {
                            alert(result.error);
                        } else {
                            if (result) {
                                alert('Có lỗi trong quá trình thêm');
                            }
                        }
                    });
                },
                onItemUpdated: function(args) {
                    $.post("/QuanTriTuyenDuong/CapNhatTuyenDuong", args.item, function(result) {
                        console.log(result);
                        if (result.error) {
                            alert(result.error);
                        } else {
                            if (result) {
                                alert('Có lỗi trong quá trình cập nhật');
                            }
                        }
                    });
                }
            });
        }
    });
</script>
